#- Finds dumpbin.exe when using MSVC
# Sets DUMPBIN_EXECUTABLE

if(MSVC)
  set(hkey PATHS "[HKEY_LOCAL_MACHINE\\Software\\Microsoft\\VisualStudio")
  if(MSVC10)
    set(hkey "${hkey}\\10.0;InstallDir]/../../VC/bin")
  elseif(MSVC90)
    set(hkey "${hkey}\\9.0;InstallDir]/../../VC/bin")
  elseif(MSVC80)
    set(hkey "${hkey}\\8.0;InstallDir]/../../VC/bin")
  elseif(MSVC71)
    set(hkey "${hkey}\\7.1;InstallDir]/../../VC7/bin")
  elseif(MSVC70)
    set(hkey "${hkey}\\7.0;InstallDir]/../../VC7/bin")
  elseif(MSVC60)
    set(hkey "${hkey}\\10.0;InstallDir]/../../VC/bin")
  else()
    message("Unknown MSVC version")
    set(hkey)
  endif()
  find_program(DUMPBIN_EXECUTABLE dumpbin.exe ${hkey})
else()
  message("Not using MSVC")
  set(DUMPBIN_EXECUTABLE DUMPBIN_EXECUTABLE-NOTFOUND)
endif()

include(FindPackageHandleStandardArgs)
find_package_handle_standard_args(Dumpbin DEFAULT_MSG DUMPBIN_EXECUTABLE)
mark_as_advanced(DUMPBIN_EXECUTABLE)
